<div align="center">
<h1>Chatgpt Dingtalk</h1>

[![Auth](https://img.shields.io/badge/Auth-eryajf-ff69b4)](https://github.com/eryajf)
[![Go Version](https://img.shields.io/github/go-mod/go-version/eryajf/chatgpt-dingtalk)](https://github.com/eryajf/chatgpt-dingtalk)
[![Gin Version](https://img.shields.io/badge/Gin-1.6.3-brightgreen)](https://github.com/eryajf/chatgpt-dingtalk)
[![Gorm Version](https://img.shields.io/badge/Gorm-1.20.12-brightgreen)](https://github.com/eryajf/chatgpt-dingtalk)
[![GitHub Issues](https://img.shields.io/github/issues/eryajf/chatgpt-dingtalk.svg)](https://github.com/eryajf/chatgpt-dingtalk/issues)
[![GitHub Pull Requests](https://img.shields.io/github/issues-pr/eryajf/chatgpt-dingtalk)](https://github.com/eryajf/chatgpt-dingtalk/pulls)
[![GitHub Pull Requests](https://img.shields.io/github/stars/eryajf/chatgpt-dingtalk)](https://github.com/eryajf/chatgpt-dingtalk/stargazers)
[![HitCount](https://views.whatilearened.today/views/github/eryajf/chatgpt-dingtalk.svg)](https://github.com/eryajf/chatgpt-dingtalk)
[![GitHub license](https://img.shields.io/github/license/eryajf/chatgpt-dingtalk)](https://github.com/eryajf/chatgpt-dingtalk/blob/main/LICENSE)

<p> ğŸŒ‰ åœ¨é’‰é’‰ç¾¤èŠä¸­æ·»åŠ chatGPTæœºå™¨äºº ğŸŒ‰</p>

<img src="https://camo.githubusercontent.com/82291b0fe831bfc6781e07fc5090cbd0a8b912bb8b8d4fec0696c881834f81ac/68747470733a2f2f70726f626f742e6d656469612f394575424971676170492e676966" width="800"  height="3">
</div><br>


## å‰è¨€

æœ€è¿‘chatGPTå¼‚å¸¸ç«çˆ†ï¼Œæœ¬é¡¹ç›®å¯ä»¥å°†GPTæœºå™¨äººé›†æˆåˆ°é’‰é’‰ç¾¤èŠä¸­ã€‚

`æ„Ÿè°¢ï¼š`è¿™ä¸ªé¡¹ç›®å€Ÿé‰´äº†[wechatbot](https://github.com/869413421/wechatbot.git)ï¼Œwechatbotæ˜¯ä¸€ä¸ªèƒ½å¤Ÿé›†æˆåˆ°ä¸ªäººå¾®ä¿¡çš„GPTæœºå™¨äººã€‚

### åŠŸèƒ½ç®€ä»‹

* æ”¯æŒåœ¨é’‰é’‰ç¾¤èŠä¸­æ·»åŠ æœºå™¨äººï¼Œé€šè¿‡@æœºå™¨äººè¿›è¡ŒèŠå¤©äº¤äº’ã€‚
* æé—®å¢åŠ ä¸Šä¸‹æ–‡(å¯èƒ½ä¸å¤ªç†æƒ³)ï¼Œæ›´æ¥è¿‘å®˜ç½‘æ•ˆæœã€‚

## ä½¿ç”¨å‰æ

* æœ‰openaiè´¦å·ï¼Œå¹¶ä¸”åˆ›å»ºå¥½api_keyï¼Œæ³¨å†Œç›¸å…³äº‹é¡¹å¯ä»¥å‚è€ƒ[æ­¤æ–‡ç« ](https://juejin.cn/post/7173447848292253704) ã€‚è®¿é—®[è¿™é‡Œ](https://beta.openai.com/account/api-keys)ï¼Œç”³è¯·ä¸ªäººç§˜é’¥ã€‚
* åœ¨é’‰é’‰å¼€å‘è€…åå°åˆ›å»ºæœºå™¨äººï¼Œé…ç½®åº”ç”¨ç¨‹åºå›è°ƒã€‚

## ä½¿ç”¨æ•™ç¨‹

### ç¬¬ä¸€æ­¥ï¼Œå…ˆåˆ›å»ºæœºå™¨äºº

åˆ›å»ºæ­¥éª¤å‚è€ƒæ–‡æ¡£ï¼š[ä¼ä¸šå†…éƒ¨å¼€å‘æœºå™¨äºº](https://open.dingtalk.com/document/robots/enterprise-created-chatbot)ï¼Œæˆ–è€…æ ¹æ®å¦‚ä¸‹æ­¥éª¤è¿›è¡Œé…ç½®ã€‚

1. åˆ›å»ºæœºå™¨äººã€‚
   ![image_20221209_163616](https://cdn.staticaly.com/gh/eryajf/tu/main/img/image_20221209_163616.png)

   æ­¥éª¤æ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚

2. é…ç½®æœºå™¨äººå›è°ƒæ¥å£ã€‚
   ![image_20221209_163652](https://cdn.staticaly.com/gh/eryajf/tu/main/img/image_20221209_163652.png)

   åˆ›å»ºå®Œæ¯•ä¹‹åï¼Œç‚¹å‡»æœºå™¨äººå¼€å‘ç®¡ç†ï¼Œç„¶åé…ç½®å°†è¦éƒ¨ç½²çš„æœåŠ¡æ‰€åœ¨æœåŠ¡å™¨çš„å‡ºå£IPï¼Œä»¥åŠå°†è¦ç»™æœåŠ¡é…ç½®çš„åŸŸåã€‚

3. å‘å¸ƒæœºå™¨äººã€‚
   ![image_20221209_163709](https://cdn.staticaly.com/gh/eryajf/tu/main/img/image_20221209_163709.png)

   ç‚¹å‡»ç‰ˆæœ¬ç®¡ç†ä¸å‘å¸ƒï¼Œç„¶åç‚¹å‡»ä¸Šçº¿ï¼Œè¿™ä¸ªæ—¶å€™å°±èƒ½åœ¨é’‰é’‰çš„ç¾¤é‡Œä¸­æ·»åŠ è¿™ä¸ªæœºå™¨äººäº†ã€‚

4. ç¾¤èŠæ·»åŠ æœºå™¨äººã€‚

   ![image_20221209_163724](https://cdn.staticaly.com/gh/eryajf/tu/main/img/image_20221209_163724.png)

### ç¬¬äºŒæ­¥ï¼Œéƒ¨ç½²åº”ç”¨

ä½ å¯ä»¥ä½¿ç”¨dockerå¿«é€Ÿè¿è¡Œæœ¬é¡¹ç›®ã€‚

`ç¬¬ä¸€ç§ï¼šåŸºäºç¯å¢ƒå˜é‡è¿è¡Œ`

```sh
# è¿è¡Œé¡¹ç›®
$ docker run -itd --name chatgpt -e ApiKey=xxxx -e SessionTimeout=60s --restart=always docker.mirrors.sjtug.sjtu.edu.cn/eryajf/chatgpt-dingtalk:latest
```

è¿è¡Œå‘½ä»¤ä¸­æ˜ å°„çš„é…ç½®æ–‡ä»¶å‚è€ƒä¸‹è¾¹çš„é…ç½®æ–‡ä»¶è¯´æ˜ã€‚

`ç¬¬äºŒç§ï¼šåŸºäºé…ç½®æ–‡ä»¶æŒ‚è½½è¿è¡Œ`

```sh
# å¤åˆ¶é…ç½®æ–‡ä»¶ï¼Œæ ¹æ®è‡ªå·±å®é™…æƒ…å†µï¼Œè°ƒæ•´é…ç½®é‡Œçš„å†…å®¹
$ cp config.dev.json config.json  # å…¶ä¸­ config.dev.json ä»é¡¹ç›®çš„æ ¹ç›®å½•è·å–

# è¿è¡Œé¡¹ç›®
docker run -itd --name chatgpt -v ./config.json:/app/config.json --restart=always docker.mirrors.sjtug.sjtu.edu.cn/eryajf/chatgpt-dingtalk:latest
```

å…¶ä¸­é…ç½®æ–‡ä»¶å‚è€ƒä¸‹è¾¹çš„é…ç½®æ–‡ä»¶è¯´æ˜ã€‚

éƒ¨ç½²å®Œæˆä¹‹åï¼Œé€šè¿‡Nginxä»£ç†æœ¬æœåŠ¡ï¼š

```nginx
server {
    listen       80;
    server_name  chat.eryajf.net;

    client_header_timeout 120s;
    client_body_timeout 120s;

    location / {
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header X-Forwarded-For $remote_addr;
        proxy_pass http://localhost:8090;
    }
}
```

éƒ¨ç½²å®Œæˆä¹‹åï¼Œå°±å¯ä»¥åœ¨ç¾¤é‡Œè‰¾ç‰¹æœºå™¨äººè¿›è¡Œä½“éªŒäº†ã€‚

æ•ˆæœå¦‚ä¸‹ï¼š

![image_20221209_163739](https://cdn.staticaly.com/gh/eryajf/tu/main/img/image_20221209_163739.png)

## æœ¬åœ°å¼€å‘

````sh
# è·å–é¡¹ç›®
$ git clone https://github.com/eryajf/chatgpt-dingtalk.git

# è¿›å…¥é¡¹ç›®ç›®å½•
$ cd chatgpt-dingtalk

# å¤åˆ¶é…ç½®æ–‡ä»¶ï¼Œæ ¹æ®ä¸ªäººå®é™…æƒ…å†µè¿›è¡Œé…ç½®
$ cp config.dev.json config.json

# å¯åŠ¨é¡¹ç›®
$ go run main.go
````

## é…ç½®æ–‡ä»¶è¯´æ˜
````json
{
    "api_key": "xxxxxxxxx",  // openai api_key
    "session_timeout": 60    // ä¼šè¯è¶…æ—¶æ—¶é—´,é»˜è®¤60ç§’,åœ¨ä¼šè¯æ—¶é—´å†…æ‰€æœ‰å‘é€ç»™æœºå™¨äººçš„ä¿¡æ¯ä¼šä½œä¸ºä¸Šä¸‹æ–‡
}
````